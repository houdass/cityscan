"use strict";var _user=require("../models/user"),_user2=_interopRequireDefault(_user),_util=require("../services/util.service"),_nightmare=require("nightmare"),_nightmare2=_interopRequireDefault(_nightmare),_jquery=require("jquery"),_jquery2=_interopRequireDefault(_jquery);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var nightmare=new _nightmare2.default({show:!0}),populateRoleAndPermissions={path:"role",populate:{path:"permissions"}},userController=function(){return{add:function(e,t,n){},edit:function(e,t){e.user.set(e.body),e.user.save(function(e,n){e?t.status(500).send(e):n.populate(populateRoleAndPermissions,function(e){e?t.status(500).send(e):t.json((0,_util.setUserInfo)(n))})})},find:function(e,t){t.json((0,_util.setUserInfo)(e.user))},findAll:function(e,t){_user2.default.find({}).populate(populateRoleAndPermissions).exec(function(e,n){if(e)t.status(500).send(e);else{var u=n.map(function(e){return(0,_util.setUserInfo)(e)});t.json(u)}})},middleware:function(e,t,n){_user2.default.findById(e.params.id).populate(populateRoleAndPermissions).exec(function(u,r){u?t.status(500).send(u):r?(e.user=r,n()):t.status(404).send("No role found")})},remove:function(e,t){e.user.remove(function(e){e?t.status(500).send(e):t.status(204).send("Successfully removed")})},scan:function(){nightmare.goto("http://www.seloger.com/").wait(2e3).type('.jsInlineContainer input[type="text"]',"paris").wait(1e3).evaluate(function(){(0,_jquery2.default)('.jsInlineContainer input[type="text"]').focus(),(0,_jquery2.default)(".selectize-dropdown")[0].style.display="block"}).wait(3e3).evaluate(function(){(0,_jquery2.default)(".optionContainer").get(0).click()}).wait(1e3).click(".b-btn.b-warn").wait(3e3).evaluate(function(){return Array.from((0,_jquery2.default)(".c-pa-list")).map(function(e){var t={};return t.price=(0,_jquery2.default)(e).find(".c-pa-price").text(),t})}).end().then(function(e){e.forEach(function(e){})}).catch(function(e){})}}};module.exports=userController;