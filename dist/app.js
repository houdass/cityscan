"use strict";var _express=require("express"),_express2=_interopRequireDefault(_express);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var compression=require("compression"),app=(0,_express2.default)(),bodyParser=require("body-parser"),logger=require("morgan"),mongoose=require("mongoose"),CONFIG=require("./config/main"),authRouter=require("./routers/auth.router")(),userRouter=require("./routers/user.router")(),roleRouter=require("./routers/role.router")(),permissionRouter=require("./routers/permission.router")();mongoose.connect(CONFIG.MONGODB_URI),"test"===process.env.ENV||(mongoose.connect(process.env.MONGODB_URI||CONFIG.MONGODB_URI),app.listen(process.env.PORT||CONFIG.PORT)),app.use(bodyParser.urlencoded({extended:!1})),app.use(bodyParser.json()),app.use(logger("dev")),app.use(compression()),app.use(function(e,r,s){r.header("Access-Control-Allow-Origin",CONFIG.CORS.origin),r.header("Access-Control-Allow-Methods",CONFIG.CORS.methods),r.header("Access-Control-Allow-Headers",CONFIG.CORS.headers),r.header("Access-Control-Allow-Credentials",CONFIG.CORS.credentials),s()});var apiRoutes=new _express2.default.Router;app.use("/api",apiRoutes),apiRoutes.use("/auth",authRouter),apiRoutes.use("/user",userRouter),apiRoutes.use("/role",roleRouter),apiRoutes.use("/permission",permissionRouter),app.use(_express2.default.static("public"));