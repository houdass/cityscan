"use strict";var passport=require("passport"),User=require("../models/user"),CONFIG=require("./main"),JwtStrategy=require("passport-jwt").Strategy,ExtractJwt=require("passport-jwt").ExtractJwt,LocalStrategy=require("passport-local"),localOptions={usernameField:"email"},localLogin=new LocalStrategy(localOptions,function(r,e,t){User.findOne({email:r},function(r,o){return r?t(r):o?void o.comparePassword(e,function(r,e){return r?t(r):e?t(null,o):t(null,!1,{error:"Your login details could not be verified. Please try again."})}):t(null,!1,{error:"Your login details could not be verified. Please try again."})})}),jwtOptions={jwtFromRequest:ExtractJwt.fromAuthHeader(),secretOrKey:CONFIG.SECRET},jwtLogin=new JwtStrategy(jwtOptions,function(r,e){User.findById(r._id,function(r,t){if(r)return e(r,!1);e(null,t||!1)})});passport.use(localLogin),passport.use(jwtLogin);